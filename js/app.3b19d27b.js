(function(t){function e(e){for(var a,i,s=e[0],c=e[1],l=e[2],d=0,v=[];d<s.length;d++)i=s[d],o[i]&&v.push(o[i][0]),o[i]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(t[a]=c[a]);u&&u(e);while(v.length)v.shift()();return r.push.apply(r,l||[]),n()}function n(){for(var t,e=0;e<r.length;e++){for(var n=r[e],a=!0,s=1;s<n.length;s++){var c=n[s];0!==o[c]&&(a=!1)}a&&(r.splice(e--,1),t=i(i.s=n[0]))}return t}var a={},o={app:0},r=[];function i(e){if(a[e])return a[e].exports;var n=a[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=a,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)i.d(n,a,function(e){return t[e]}.bind(null,a));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=e,s=s.slice();for(var l=0;l<s.length;l++)e(s[l]);var u=c;r.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"22d5":function(t,e,n){"use strict";var a=n("ff47"),o=n.n(a);o.a},"56d7":function(t,e,n){"use strict";n.r(e);n("cadf"),n("551c"),n("097d");var a=n("2b0e"),o=n("d437"),r=n.n(o),i=n("d421"),s=n.n(i),c=n("5d92"),l=n.n(c),u=n("6a6f"),d=n.n(u),v=n("b3ee"),p=n.n(v),f=n("d553"),m=n.n(f),h=n("c713"),b=n.n(h),_=n("9861"),k=n.n(_),g=n("e1f0"),x=n.n(g),y=n("cf3f"),S=n.n(y),w=n("6227"),O=n.n(w),C=n("68d6"),M=n.n(C),T=n("49f8"),j=n.n(T),E=n("0fad"),$=n.n(E),D=n("341d"),A=n.n(D),L=n("25b1"),R=n.n(L),G=n("12d0"),P=n.n(G),V=n("535c"),B=n.n(V);n("da64");a["default"].use(r.a,{iconfont:"md",components:{VApp:s.a,VBtn:l.a,VIcon:d.a,VChip:p.a,VGrid:m.a,VCard:b.a,VMenu:k.a,VList:x.a,VDialog:S.a,VStepper:O.a,VDivider:M.a,VSubheader:j.a,VAutocomplete:$.a,VProgressCircular:A.a,VSnackbar:R.a,VToolbar:P.a,VNavigationDrawer:B.a}});var U=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-app",{attrs:{dark:t.dark}},[n("NavBar",{on:{dark:function(e){t.dark=!t.dark}}}),n("v-content",[n("router-view")],1)],1)},I=[],F=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-toolbar",{attrs:{app:""}},[n("v-toolbar-side-icon",{on:{click:function(e){e.stopPropagation(),t.drawer=!t.drawer}}}),n("v-toolbar-title",[t._v("SUTD Timetable")]),n("v-spacer"),n("v-menu",{attrs:{"offset-y":""}},[n("v-btn",{attrs:{slot:"activator",icon:""},slot:"activator"},[n("v-icon",[t._v("more_vert")])],1),n("v-list",t._l(t.menu,function(e){return n("v-list-tile",t._b({key:e.text,on:{click:e.click}},"v-list-tile",e,!1),[n("v-list-tile-content",{domProps:{textContent:t._s(e.text)}}),n("v-list-tile-action",[n("v-icon",{domProps:{textContent:t._s(e.action)}})],1)],1)}))],1)],1),n("v-navigation-drawer",{attrs:{clipped:"",app:""},model:{value:t.drawer,callback:function(e){t.drawer=e},expression:"drawer"}},[n("v-list",t._l(t.links,function(e){return n("v-list-tile",{key:e.name,attrs:{to:e}},[n("v-list-tile-action",[n("v-icon",{domProps:{textContent:t._s(e.action)}})],1),n("v-list-tile-content",[n("v-list-tile-title",{domProps:{textContent:t._s(e.name)}})],1)],1)}))],1)],1)},H=[],N=function(){},q={data:function(){var t=this;return{drawer:!1,menu:[{text:"Dark Mode",action:"brightness_4",click:function(){return t.$emit("dark")}},{text:"Source",action:"open_in_new",target:"_blank",click:N,href:"https://github.com/OpenSUTD/sutd-timetable"},{text:"Back to v1",action:"restore",click:N,href:"https://sutd-timetable.herokuapp.com"}],links:[{name:"Main",action:"dashboard"},{name:"Modules",action:"view_list"},{name:"Upload",action:"file_upload"}]}}},Y=q,W=n("2877"),z=Object(W["a"])(Y,F,H,!1,null,null,null);z.options.__file="NavBar.vue";var J=z.exports,Z={components:{NavBar:J},data:function(){return{dark:!0}}},K=Z,Q=Object(W["a"])(K,U,I,!1,null,null,null);Q.options.__file="App.vue";var X=Q.exports,tt=n("8c4f"),et=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-container",{attrs:{fluid:"","grid-list-sm":""}},[n("v-layout",{attrs:{row:"",wrap:""}},[n("v-flex",{attrs:{xs12:""}},[n("v-card",[n("v-card-title",{attrs:{"primary-title":""}},[n("div",{staticClass:"headline"},[t._v("Welcome to SUTD Timetables!")])]),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{to:{name:"Upload"}}},[t._v("Upload Timetable")]),n("v-btn",{attrs:{to:{name:"Modules"}}},[t._v("All modules")])],1)],1)],1),n("v-flex",{attrs:{xs12:""}},[n("v-card",[n("v-card-title",{staticClass:"headline"},[t._v("Module Search")]),n("v-card-text",[n("v-autocomplete",{attrs:{multiple:"",dense:"",chips:"",clearable:"",label:"Find Sections",items:t.items},scopedSlots:t._u([{key:"selection",fn:function(e){return[n("v-chip",{attrs:{close:"",small:"",selected:e.selected},on:{input:function(n){t.remove(e)}}},[t._v("\n                "+t._s(e.item.chip)+"\n              ")])]}}]),model:{value:t.$root.selected,callback:function(e){t.$set(t.$root,"selected",e)},expression:"$root.selected"}}),n("v-subheader",[t._v("Subscription URL")]),n("code",{domProps:{textContent:t._s(t.calURL)}})],1),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{disabled:!t.$root.selected.length},nativeOn:{click:function(e){return t.copyCal(e)}}},[t._v("\n            Copy to Clipboard\n          ")])],1)],1)],1)],1),n("v-snackbar",{attrs:{bottom:""},model:{value:t.snack.show,callback:function(e){t.$set(t.snack,"show",e)},expression:"snack.show"}},[t._v("\n    "+t._s(t.snack.text)+"\n    "),n("v-btn",{attrs:{flat:"",color:"pink"},nativeOn:{click:function(e){t.snack.show=!1}}},[t._v("Close")])],1)],1)},nt=[],at=(n("55dd"),n("7f7f"),n("ac6a"),n("8615"),n("8afe")),ot="https://us-central1-sutd-timetable.cloudfunctions.net",rt={data:function(){return{snack:{text:"",show:!1}}},computed:{term:function(){return this.$root.timetable.term?this.$root.timetable.term.join("-"):""},items:function(){var t;if(!this.term)return[];var e=this.$root.timetable.sections[this.term],n=this.$root.timetable.modules,a=!0;return(t=[]).concat.apply(t,Object(at["a"])(Object.values(n).map(function(t){var n="".concat(t.code," - ").concat(t.title);return t.sections?[{header:n}].concat(Object(at["a"])(t.sections.map(function(a){var o=e[a].name;return{value:a,chip:"".concat(t.code,": ").concat(o),text:"".concat(o," (").concat(n,")")}})),[{divider:a}]):[]})))},calURL:function(){var t=this.$root.selected,e=t.length>0?t.sort().join(","):"";return"".concat(ot,"/calendar?t=").concat(this.term,"&s=").concat(e)}},methods:{remove:function(t){t.parent.selectItem(t.item)},copyCal:function(){var t=document.createElement("textarea");t.value=this.calURL,document.body.appendChild(t),t.select();var e=!1;try{e=document.execCommand("copy")}catch(t){}document.body.removeChild(t),this.snack.text=e?"Copied to clipboard":"Could not copy",this.snack.show=!0}}},it=rt,st=Object(W["a"])(it,et,nt,!1,null,null,null);st.options.__file="Main.vue";var ct=st.exports,lt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-stepper",{model:{value:t.step,callback:function(e){t.step=e},expression:"step"}},[n("v-stepper-header",[n("v-stepper-step",{attrs:{step:"1",complete:t.step>1}},[t._v("Get Timetable")]),n("v-divider"),n("v-stepper-step",{attrs:{step:"2",complete:t.step>2}},[t._v("Upload Timetable")]),n("v-divider"),n("v-stepper-step",{attrs:{step:"3"}},[t._v("Complete")])],1),n("v-stepper-items",[n("v-stepper-content",{attrs:{step:"1"}},[n("v-card",[n("v-card-title",{staticClass:"headline"},[t._v("Get Timetable File")]),n("v-card-text",[n("v-container",{attrs:{fluid:"","grid-list-sm":""}},[n("v-layout",{attrs:{row:"",wrap:""}},[n("v-flex",{attrs:{xs12:"",sm6:""}},[n("v-btn",{attrs:{block:"",href:t.SAMS,target:"_blank"},nativeOn:{click:function(e){t.clikd=!0}}},[t._v("\n                    1. Login to SAMS\n                    "),n("v-icon",{attrs:{right:""}},[t._v("open_in_new")])],1)],1),n("v-flex",{attrs:{xs12:"",sm6:""}},[n("v-btn",{attrs:{block:"",href:t.GBL,disabled:!t.clikd},on:{click:function(t){t.preventDefault()}}},[t._v("\n                    2. Right Click & Save\n                    "),n("v-icon",{attrs:{right:""}},[t._v("file_download")])],1)],1)],1)],1)],1),n("v-card-actions",[n("v-spacer"),n("v-btn",{nativeOn:{click:function(e){t.step=2}}},[t._v("I have it")])],1)],1)],1),n("v-stepper-content",{attrs:{step:"2"}},[n("v-card",[n("v-card-title",{staticClass:"headline"},[t._v("Upload Timetable")]),n("v-card-text",[n("label",[n("div",{staticClass:"blue-grey white--text text-xs-center elevation-2 pa-3"},[t._v("\n                Choose File\n                "),n("v-icon",{attrs:{right:"",dark:""}},[t._v("attach_file")])],1),n("input",{attrs:{id:"file",type:"file"},on:{change:t.handleFile}})])]),t.processed.length>0?n("v-list",{attrs:{dense:""}},t._l(t.processed.modules,function(e){return n("v-list-tile",{key:e.code},[n("v-list-tile-content",[n("v-list-tile-title",[t._v(t._s(e.code))]),n("v-list-tile-sub-title",[t._v(t._s(e.title))])],1)],1)})):t._e(),n("v-card-actions",[n("v-btn",{attrs:{disabled:t.sending},nativeOn:{click:function(e){t.step=1}}},[t._v("Back")]),n("v-spacer"),n("v-btn",{attrs:{color:"primary",disabled:t.sending||!t.processed.length},nativeOn:{click:function(e){return t.upload(e)}}},[t._v("\n              Upload\n              "),n("v-icon",{attrs:{right:""}},[t._v("cloud_upload")])],1)],1)],1)],1),n("v-stepper-content",{attrs:{step:"3"}},[n("v-card",[n("v-card-title",{staticClass:"headline"},[t._v("Thank You")]),n("v-card-text",[t._v("\n            Your timetable has been submitted.\n          ")]),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"primary",to:{name:"Main"}}},[t._v("Go back")])],1)],1)],1)],1)],1),n("v-dialog",{model:{value:t.mobile,callback:function(e){t.mobile=e},expression:"mobile"}},[n("v-card",[n("v-card-title",{staticClass:"headline"},[t._v("Mobile Browser detected")]),n("v-card-text",[t._v("\n        Downloading HTML on mobile browsers is still wonky.\n        You might have to use a desktop for this.\n      ")]),n("v-card-actions",[n("v-btn",{nativeOn:{click:function(e){t.$router.go(-1)}}},[t._v("Go back")]),n("v-spacer"),n("v-btn",{nativeOn:{click:function(e){t.mobile=!1}}},[t._v("Continue")])],1)],1)],1),n("v-snackbar",{attrs:{top:"",color:t.snack.color},model:{value:t.snack.show,callback:function(e){t.$set(t.snack,"show",e)},expression:"snack.show"}},[t._v("\n    "+t._s(t.snack.text)+"\n    "),n("v-btn",{attrs:{flat:""},nativeOn:{click:function(e){t.snack.show=!1}}},[t._v("Close")])],1)],1)},ut=[],dt=n("a322"),vt=(n("a481"),n("456d"),n("f751"),n("f559"),n("28a5"),n("9393")),pt=n("2cf3"),ft=n("92c8"),mt=n("f7f1"),ht='div[id^="win0divDERIVED_REGFRM1_DESCR20"]',bt='tr[id^="trCLASS_MTG_VW"]',_t='span[id^="MTG"]',kt="PAGROUPDIVIDER",gt='span[id^="DERIVED_CLS_DTL_CLASS_NBR"]',xt={Mo:1,Tu:2,We:3,Th:4,Fr:5},yt=function(t,e){return t[e]=(t[e]||0)+1,t},St=function(t,e){var n=Object(pt["a"])(t,"HH:mm",e);return n.getTime()===n.getTime()?n:Object(pt["a"])(t,"HH:mmaa",e)},wt=function(t){var e={sections:[],modules:[]},n={},a=[],o=[],r=new Date,i=document.createElement("div");i.insertAdjacentHTML("beforeend",t.replace(/<img[^>]*>/g,"")),i.querySelectorAll(ht).forEach(function(t){var i=[],s=null,c=null,l=null,u=t.getElementsByClassName(kt)[0].innerText.split(" - "),d=Object(vt["a"])(u,2),v=d[0],p=d[1];v=v.replace(" ",""),t.querySelectorAll(bt).forEach(function(t){var u={};t.querySelectorAll(_t).forEach(function(t){u[t.id.split("$")[0]]=t.innerText})," "!==u.MTG_COMP&&(l=u.MTG_COMP);var d=t.querySelector(gt).innerText;" "!==d&&(s=parseInt(d),i.push(s),e.sections.push(s),u.MTG_SECTION&&(c=u.MTG_SECTION),n[s]={name:c,module:v,schedule:[]},v.startsWith("10.")&&c.startsWith("SC")&&a.push(c.replace("SC","F")));var p=u.MTG_DATES.split(" - ").map(function(t){return Object(pt["a"])(t,"dd/MM/yyyy",r)}),f=u.MTG_SCHED.split(/ (.+)? - (.+)/,3),m=f.shift(),h=p[0];h.getDay()!==xt[m]&&(h=Object(ft["a"])(h,xt[m])),o.push(h);var b={component:l,location:u.MTG_LOC};do{var _=f.map(function(t){return St(t,h)}),k=Object(vt["a"])(_,2),g=k[0],x=k[1],y=Object.assign({start:g,end:x},b);n[s].schedule.push(y),h=Object(mt["a"])(h,7)}while(h<=p[1])}),i.sort(),e.modules.push({code:v,title:p,sections:i})});var s=new Date(Math.min.apply(Math,o));e.term=s.getFullYear()+"-"+s.getMonth()/4;var c=Object.keys(a.reduce(yt,{}));return e.freshmore=1===c.length?c[0]:null,e.sections.sort(),Object.assign(e,{schedules:n,length:e.modules.length})},Ot="https://sams.sutd.edu.sg/",Ct="psc/CSPRD/EMPLOYEE/HRMS/c/SA_LEARNER_SERVICES.SSR_SSENRL_LIST.GBL",Mt={data:function(){return{processed:{},snack:{show:!1,text:""},GBL:Ot+Ct,SAMS:Ot,sending:!1,mobile:!1,clikd:!1,step:1}},mounted:function(){this.mobile=/iP|Android/i.test(navigator.userAgent)},methods:{snackBar:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"error";this.snack={show:!0,text:t,color:e}},upload:function(){var t=this;this.sending=!0;var e=this.processed,n=this.$root.$firebaseRefs.timetable,a=e.freshmore||e.sections.reduce(function(t,e){return t+e},0),o={};e.modules.forEach(function(t){o[t.code.replace(".","-")]=t}),Promise.all([n.child("modules").update(o),n.child("groups").update(Object(dt["a"])({},a,e.sections)),n.child("sections").child(e.term).update(e.schedules)]).then(function(){t.$set(t.$root,"selected",e.sections),t.sending=!1,t.step=3})},handleFile:function(t){var e=this;this.processed={};var n=t.target.files[0];if(n)if(n.type&&"text/html"!==n.type)this.snackBar("The file is not a HTML file.");else if(n.size>1e6)this.snackBar("The file is too large.");else{var a=new FileReader;a.onload=function(t){var n=wt(t.target.result);0===n.length?e.snackBar("Could not find anything."):(e.snackBar("Found ".concat(n.length," modules"),"success"),e.processed=n)},a.readAsText(n.slice(0,1048576))}}}},Tt=Mt,jt=(n("22d5"),Object(W["a"])(Tt,lt,ut,!1,null,"717161dc",null));jt.options.__file="Upload.vue";var Et=jt.exports,$t=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-container",{attrs:{fluid:"","grid-list-sm":""}},[n("v-layout",{attrs:{row:"",wrap:""}},[n("v-flex",{attrs:{xs12:""}},[n("v-card",[n("v-card-title",{staticClass:"headline"},[t._v("Module list")]),n("v-card-text",[t._v("\n          Can't find your module?\n          "),n("router-link",{attrs:{to:{name:"Upload"}}},[t._v("\n            Upload your timetable\n          ")])],1)],1)],1),t._l(t.modGroups,function(e,a){return n("v-flex",{key:a,attrs:{xs12:"",sm6:"",md4:"",value:e.active}},[n("v-card",[n("v-card-title",{staticClass:"title"},[t._v(t._s(e.title))]),n("v-list",t._l(e.modules,function(e){return n("v-list-group",{key:e.code},[n("v-list-tile",{attrs:{slot:"activator"},slot:"activator"},[n("v-list-tile-content",[n("v-list-tile-title",[t._v(t._s(e.title))]),n("v-list-tile-sub-title",[t._v(t._s(e.code))])],1)],1),t._l(e.sections,function(e){return n("v-list-tile",{key:e,on:{click:function(n){t.toggle(e)}}},[n("v-list-tile-content",[n("v-list-tile-title",[t._v(t._s(t.term[e].name))])],1),n("v-list-tile-action",[t.selected.indexOf(e)>-1?n("v-icon",[t._v("check_box")]):n("v-icon",[t._v("check_box_outline_blank")])],1)],1)})],2)}))],1)],1)})],2)],1)},Dt=[],At=[[/^01/,"General"],[/^02/,"HASS"],[/^(03|10)/,"Freshmore"],[/^20/,"ASD"],[/^30/,"EPD"],[/^40/,"ESD"],[/^50/,"ISTD"]],Lt=function(t){return function(e){return t.test(e.code)}},Rt={data:function(){return{}},computed:{selected:function(){return this.$root.selected},term:function(){if(!this.$root.timetable.term)return{};var t=this.$root.timetable.term.join("-");return this.$root.timetable.sections[t]},modGroups:function(){var t=this.$root.timetable.modules||{};return At.map(function(e){var n=Object(vt["a"])(e,2),a=n[0],o=n[1],r=Object.values(t).filter(Lt(a));return{title:o,modules:r,active:!1}})}},methods:{toggle:function(t){var e=this.selected.indexOf(t);e>-1?this.selected.splice(e,1):this.selected.push(t)}}},Gt=Rt,Pt=Object(W["a"])(Gt,$t,Dt,!1,null,null,null);Pt.options.__file="Modules.vue";var Vt=Pt.exports;a["default"].use(tt["a"]);var Bt=[{path:"/main",name:"Main",component:ct},{path:"/upload",name:"Upload",component:Et},{path:"/mods",name:"Modules",component:Vt},{path:"*",redirect:"/main"}],Ut=new tt["a"]({routes:Bt,scrollBehavior:function(){return{x:0,y:0}}}),It=n("5f30"),Ft=n.n(It),Ht=n("59ca"),Nt=n.n(Ht),qt=(n("66ce"),Nt.a.initializeApp({projectId:"sutd-timetable",messagingSenderId:"264299846651",storageBucket:"sutd-timetable.appspot.com",authDomain:"sutd-timetable.firebaseapp.com",apiKey:"AIzaSyBefOvL56JqZpZbA1jqojMlM0u5ais4CYo",databaseURL:"https://sutd-timetable.firebaseio.com"}));a["default"].use(Ft.a);var Yt={timetable:{asObject:!0,source:qt.database().ref()}};a["default"].config.productionTip=!1;var Wt={selected:[]};new a["default"]({data:Wt,router:Ut,firebase:Yt,render:function(t){return t(X)}}).$mount("#app")},ff47:function(t,e,n){}});
//# sourceMappingURL=app.3b19d27b.js.map