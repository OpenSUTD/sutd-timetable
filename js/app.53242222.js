(function(t){function e(e){for(var a,r,s=e[0],c=e[1],l=e[2],d=0,v=[];d<s.length;d++)r=s[d],o[r]&&v.push(o[r][0]),o[r]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(t[a]=c[a]);u&&u(e);while(v.length)v.shift()();return i.push.apply(i,l||[]),n()}function n(){for(var t,e=0;e<i.length;e++){for(var n=i[e],a=!0,s=1;s<n.length;s++){var c=n[s];0!==o[c]&&(a=!1)}a&&(i.splice(e--,1),t=r(r.s=n[0]))}return t}var a={},o={app:0},i=[];function r(e){if(a[e])return a[e].exports;var n=a[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=t,r.c=a,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)r.d(n,a,function(e){return t[e]}.bind(null,a));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=e,s=s.slice();for(var l=0;l<s.length;l++)e(s[l]);var u=c;i.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"56d7":function(t,e,n){"use strict";n.r(e);n("cadf"),n("551c"),n("097d");var a=n("2b0e"),o=n("d437"),i=n.n(o),r=n("d421"),s=n.n(r),c=n("5d92"),l=n.n(c),u=n("6a6f"),d=n.n(u),v=n("d553"),p=n.n(v),f=n("9861"),m=n.n(f),h=n("e1f0"),b=n.n(h),_=n("c713"),k=n.n(_),g=n("b3ee"),x=n.n(g),y=n("cf3f"),S=n.n(y),w=n("68d6"),O=n.n(w),C=n("6227"),M=n.n(C),T=n("12d0"),j=n.n(T),E=n("25b1"),$=n.n(E),D=n("49f8"),A=n.n(D),G=n("0fad"),L=n.n(G),R=n("535c"),V=n.n(R),P=n("341d"),B=n.n(P),U=n("2330"),I=n.n(U);n("da64");a["default"].use(i.a,{components:{VApp:s.a,VBtn:l.a,VIcon:d.a,VGrid:p.a,VList:b.a,VMenu:m.a,VCard:k.a,VChip:x.a,VDialog:S.a,VDivider:O.a,VStepper:M.a,VToolbar:j.a,VSnackbar:$.a,VSubheader:A.a,VAutocomplete:L.a,VNavigationDrawer:V.a,VProgressCircular:B.a,transitions:I.a},iconfont:"md"});var F=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-app",{attrs:{dark:t.dark}},[n("NavBar",{on:{dark:function(e){t.dark=!t.dark}}}),n("v-content",[n("router-view")],1)],1)},N=[],H=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-toolbar",{attrs:{app:""}},[n("v-toolbar-side-icon",{on:{click:function(e){e.stopPropagation(),t.drawer=!t.drawer}}}),n("v-toolbar-title",[t._v("SUTD Timetable")]),n("v-spacer"),n("v-menu",{attrs:{"offset-y":""}},[n("v-btn",{attrs:{slot:"activator",icon:""},slot:"activator"},[n("v-icon",[t._v("more_vert")])],1),n("v-list",t._l(t.menu,function(e){return n("v-list-tile",t._b({key:e.text,on:{click:e.click}},"v-list-tile",e,!1),[n("v-list-tile-content",{domProps:{textContent:t._s(e.text)}}),n("v-list-tile-action",[n("v-icon",{domProps:{textContent:t._s(e.action)}})],1)],1)}))],1)],1),n("v-navigation-drawer",{attrs:{clipped:"",app:""},model:{value:t.drawer,callback:function(e){t.drawer=e},expression:"drawer"}},[n("v-list",t._l(t.links,function(e){return n("v-list-tile",{key:e.name,attrs:{to:e}},[n("v-list-tile-action",[n("v-icon",{domProps:{textContent:t._s(e.action)}})],1),n("v-list-tile-content",[n("v-list-tile-title",{domProps:{textContent:t._s(e.name)}})],1)],1)}))],1)],1)},q=[],Y=function(){},W={data:function(){var t=this;return{drawer:!1,menu:[{text:"Dark Mode",action:"brightness_4",click:function(){return t.$emit("dark")}},{text:"Source",action:"open_in_new",target:"_blank",click:Y,href:"https://github.com/randName/sutd-timetable"},{text:"Back to v1",action:"restore",click:Y,href:"https://sutd-timetable.herokuapp.com"}],links:[{name:"Main",action:"dashboard"},{name:"Modules",action:"view_list"},{name:"Upload",action:"file_upload"}]}}},Q=W,z=n("2877"),J=Object(z["a"])(Q,H,q,!1,null,null,null);J.options.__file="NavBar.vue";var Z=J.exports,K={components:{NavBar:Z},data:function(){return{dark:!0}}},X=K,tt=Object(z["a"])(X,F,N,!1,null,null,null);tt.options.__file="App.vue";var et=tt.exports,nt=n("8c4f"),at=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-container",{attrs:{fluid:"","grid-list-sm":""}},[n("v-layout",{attrs:{row:"",wrap:""}},[n("v-flex",{attrs:{xs12:""}},[n("v-card",[n("v-card-title",{attrs:{"primary-title":""}},[n("div",{staticClass:"headline"},[t._v("Welcome to SUTD Timetables!")])]),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{to:{name:"Upload"}}},[t._v("Upload Timetable")]),n("v-btn",{attrs:{to:{name:"Modules"}}},[t._v("All modules")])],1)],1)],1),n("v-flex",{attrs:{xs12:""}},[n("v-card",[n("v-card-title",{staticClass:"headline"},[t._v("Module Search")]),n("v-card-text",[n("v-autocomplete",{attrs:{multiple:"",dense:"",chips:"",clearable:"",label:"Find Sections",items:t.items},scopedSlots:t._u([{key:"selection",fn:function(e){return[n("v-chip",{attrs:{close:"",small:"",selected:e.selected},on:{input:function(t){e.parent.selectItem(e.item)}}},[t._v(t._s(e.item.chip))])]}}]),model:{value:t.$root.selected,callback:function(e){t.$set(t.$root,"selected",e)},expression:"$root.selected"}}),n("v-subheader",[t._v("Subscription URL")]),n("code",[t._v(t._s(t.calURL)+t._s(t.calQS))])],1),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{disabled:!t.calQS},nativeOn:{click:function(e){return t.copyCal(e)}}},[t._v("Copy to Clipboard")])],1)],1)],1)],1),n("v-snackbar",{attrs:{bottom:""},model:{value:t.snack.show,callback:function(e){t.$set(t.snack,"show",e)},expression:"snack.show"}},[t._v("\n    "+t._s(t.snack.text)+"\n    "),n("v-btn",{attrs:{flat:"",color:"pink"},nativeOn:{click:function(e){t.snack.show=!1}}},[t._v("Close")])],1)],1)},ot=[],it=(n("55dd"),n("7f7f"),n("ac6a"),n("8615"),n("8afe")),rt="https://us-central1-sutd-timetable.cloudfunctions.net/calendar?",st={data:function(){return{calURL:rt,snack:{text:"",show:!1}}},computed:{term:function(){return this.$root.timetable.term?this.$root.timetable.term.join("-"):""},items:function(){var t;if(!this.term)return[];var e=this.$root.timetable.sections[this.term],n=this.$root.timetable.modules,a=!0;return(t=[]).concat.apply(t,Object(it["a"])(Object.values(n).map(function(t){var n="".concat(t.code," - ").concat(t.title);return t.sections?[{header:n}].concat(Object(it["a"])(t.sections.map(function(a){var o=e[a].name;return{value:a,chip:"".concat(t.code,": ").concat(o),text:"".concat(o," (").concat(n,")")}})),[{divider:a}]):[]})))},calQS:function(){var t=this.$root.selected,e=t.length>0?t.sort().join(","):"";return"t=".concat(this.term,"&s=").concat(e)}},methods:{copyCal:function(){var t=document.createElement("textarea");t.value=rt+this.calQS,document.body.appendChild(t),t.select();var e=!1;try{e=document.execCommand("copy")}catch(t){}document.body.removeChild(t),this.snack.text=e?"Copied to clipboard":"Could not copy",this.snack.show=!0}}},ct=st,lt=Object(z["a"])(ct,at,ot,!1,null,null,null);lt.options.__file="Main.vue";var ut=lt.exports,dt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-stepper",{model:{value:t.step,callback:function(e){t.step=e},expression:"step"}},[n("v-stepper-header",[n("v-stepper-step",{attrs:{step:"1",complete:t.step>1}},[t._v("Get Timetable")]),n("v-divider"),n("v-stepper-step",{attrs:{step:"2",complete:t.step>2}},[t._v("Upload Timetable")]),n("v-divider"),n("v-stepper-step",{attrs:{step:"3"}},[t._v("Complete")])],1),n("v-stepper-items",[n("v-stepper-content",{attrs:{step:"1"}},[n("v-card",[n("v-card-title",{staticClass:"headline"},[t._v("Get Timetable File")]),n("v-card-text",[n("v-container",{attrs:{fluid:"","grid-list-sm":""}},[n("v-layout",{attrs:{row:"",wrap:""}},[n("v-flex",{attrs:{xs12:""}},[n("v-btn",{attrs:{block:"",target:"_blank",href:t.SAMS},nativeOn:{click:function(e){t.clikd=!0}}},[t._v("\n                    1. Login to SAMS\n                    "),n("v-icon",{attrs:{right:""}},[t._v("open_in_new")])],1)],1),n("v-flex",{attrs:{xs12:""}},[n("v-btn",{attrs:{block:"",href:t.GBL,disabled:!t.clikd},nativeOn:{click:function(e){t.step=2}}},[t._v("\n                    2. Right Click & Save\n                    "),n("v-icon",{attrs:{right:""}},[t._v("file_download")])],1)],1)],1)],1)],1),n("v-card-actions",[n("v-spacer"),n("v-btn",{nativeOn:{click:function(e){t.step=2}}},[t._v("I have it")])],1)],1)],1),n("v-stepper-content",{attrs:{step:"2"}},[n("v-card",[n("v-card-title",{staticClass:"headline"},[t._v("Upload Timetable")]),n("v-card-text",[n("label",[n("div",{staticClass:"blue-grey white--text text-xs-center elevation-2 pa-3"},[t._v("\n                Choose File\n                "),n("v-icon",{attrs:{right:"",dark:""}},[t._v("attach_file")])],1),n("input",{attrs:{id:"file",type:"file"},on:{change:t.handleFile}})])]),t.processed.length>0?n("v-list",{attrs:{dense:""}},t._l(t.processed.modules,function(e){return n("v-list-tile",{key:e.code},[n("v-list-tile-content",[n("v-list-tile-title",[t._v(t._s(e.code))]),n("v-list-tile-sub-title",[t._v(t._s(e.title))])],1)],1)})):t._e(),n("v-card-actions",[n("v-btn",{attrs:{disabled:t.sending},nativeOn:{click:function(e){t.step=1}}},[t._v("Back")]),n("v-spacer"),n("v-btn",{attrs:{color:"primary",disabled:t.sending||!t.processed.length},nativeOn:{click:function(e){return t.upload(e)}}},[t._v("\n              Upload\n              "),n("v-icon",{attrs:{right:""}},[t._v("cloud_upload")])],1)],1)],1)],1),n("v-stepper-content",{attrs:{step:"3"}},[n("v-card",[n("v-card-title",{staticClass:"headline"},[t._v("Thank You")]),n("v-card-text",[t._v("\n            Your timetable has been submitted.\n          ")]),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"primary",to:{name:"Main"}}},[t._v("Go back")])],1)],1)],1)],1)],1),n("v-dialog",{model:{value:t.mobile,callback:function(e){t.mobile=e},expression:"mobile"}},[n("v-card",[n("v-card-title",{staticClass:"headline"},[t._v("Mobile Browser detected")]),n("v-card-text",[t._v("\n        Downloading HTML on mobile browsers is still wonky.\n        You might have to use a desktop for this.\n      ")]),n("v-card-actions",[n("v-btn",{nativeOn:{click:function(e){t.$router.go(-1)}}},[t._v("Go back")]),n("v-spacer"),n("v-btn",{nativeOn:{click:function(e){t.mobile=!1}}},[t._v("Continue")])],1)],1)],1),n("v-snackbar",{attrs:{top:"",color:t.snack.color},model:{value:t.snack.show,callback:function(e){t.$set(t.snack,"show",e)},expression:"snack.show"}},[t._v("\n    "+t._s(t.snack.text)+"\n    "),n("v-btn",{attrs:{flat:""},nativeOn:{click:function(e){t.snack.show=!1}}},[t._v("Close")])],1)],1)},vt=[],pt=n("a322"),ft=(n("a481"),n("456d"),n("f751"),n("f559"),n("28a5"),n("9393")),mt=n("2cf3"),ht=n("92c8"),bt=n("f7f1"),_t='div[id^="win0divDERIVED_REGFRM1_DESCR20"]',kt='tr[id^="trCLASS_MTG_VW"]',gt='span[id^="MTG"]',xt="PAGROUPDIVIDER",yt='span[id^="DERIVED_CLS_DTL_CLASS_NBR"]',St={Mo:1,Tu:2,We:3,Th:4,Fr:5},wt=function(t,e){return t[e]=(t[e]||0)+1,t},Ot=function(t,e){var n=Object(mt["a"])(t,"HH:mm",e);return n.getTime()===n.getTime()?n:Object(mt["a"])(t,"HH:mmaa",e)},Ct=function(t){var e={sections:[],modules:[]},n={},a=[],o=[],i=new Date,r=document.createElement("div");r.insertAdjacentHTML("beforeend",t.replace(/<img[^>]*>/g,"")),r.querySelectorAll(_t).forEach(function(t){var r=[],s=null,c=null,l=null,u=t.getElementsByClassName(xt)[0].innerText.split(" - "),d=Object(ft["a"])(u,2),v=d[0],p=d[1];v=v.replace(" ",""),t.querySelectorAll(kt).forEach(function(t){var u={};t.querySelectorAll(gt).forEach(function(t){u[t.id.split("$")[0]]=t.innerText})," "!==u.MTG_COMP&&(l=u.MTG_COMP);var d=t.querySelector(yt).innerText;" "!==d&&(s=parseInt(d),r.push(s),e.sections.push(s),u.MTG_SECTION&&(c=u.MTG_SECTION),n[s]={name:c,module:v,schedule:[]},v.startsWith("10.")&&c.startsWith("SC")&&a.push(c.replace("SC","F")));var p=u.MTG_DATES.split(" - ").map(function(t){return Object(mt["a"])(t,"dd/MM/yyyy",i)}),f=u.MTG_SCHED.split(/ (.+)? - (.+)/,3),m=f.shift(),h=p[0];h.getDay()!==St[m]&&(h=Object(ht["a"])(h,St[m])),o.push(h);var b={component:l,location:u.MTG_LOC};do{var _=f.map(function(t){return Ot(t,h)}),k=Object(ft["a"])(_,2),g=k[0],x=k[1],y=Object.assign({start:g,end:x},b);n[s].schedule.push(y),h=Object(bt["a"])(h,7)}while(h<=p[1])}),r.sort(),e.modules.push({code:v,title:p,sections:r})});var s=new Date(Math.min.apply(Math,o));e.term=s.getFullYear()+"-"+s.getMonth()/4;var c=Object.keys(a.reduce(wt,{}));return e.freshmore=1===c.length?c[0]:null,e.sections.sort(),Object.assign(e,{schedules:n,length:e.modules.length})},Mt="https://sams.sutd.edu.sg/",Tt="psc/CSPRD/EMPLOYEE/HRMS/c/SA_LEARNER_SERVICES.SSR_SSENRL_LIST.GBL",jt={data:function(){return{processed:{},snack:{show:!1,text:""},GBL:Mt+Tt,SAMS:Mt,sending:!1,mobile:!1,clikd:!1,step:1}},mounted:function(){this.mobile=/iP|Android/i.test(navigator.userAgent)},methods:{snackBar:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"error";this.snack={show:!0,text:t,color:e}},upload:function(){var t=this;this.sending=!0;var e=this.processed,n=this.$root.$firebaseRefs.timetable,a=e.freshmore||e.sections.reduce(function(t,e){return t+e},0),o={};e.modules.forEach(function(t){o[t.code.replace(".","-")]=t}),Promise.all([n.child("modules").update(o),n.child("groups").update(Object(pt["a"])({},a,e.sections)),n.child("sections").child(e.term).update(e.schedules)]).then(function(){t.$set(t.$root,"selected",e.sections),t.sending=!1,t.step=3})},handleFile:function(t){var e=this;this.processed={};var n=t.target.files[0];if(n)if(n.type&&"text/html"!==n.type)this.snackBar("The file is not a HTML file.");else if(n.size>1e6)this.snackBar("The file is too large.");else{var a=new FileReader;a.onload=function(t){var n=Ct(t.target.result);0===n.length?e.snackBar("Could not find anything."):(e.snackBar("Found ".concat(n.length," modules"),"success"),e.processed=n)},a.readAsText(n.slice(0,1048576))}}}},Et=jt,$t=(n("b91f"),Object(z["a"])(Et,dt,vt,!1,null,"43bb77d0",null));$t.options.__file="Upload.vue";var Dt=$t.exports,At=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-container",{attrs:{fluid:"","grid-list-sm":""}},[n("v-layout",{attrs:{row:"",wrap:""}},[n("v-flex",{attrs:{xs12:""}},[n("v-card",[n("v-card-title",{staticClass:"headline"},[t._v("Module list")]),n("v-card-text",[t._v("\n          Can't find your module?\n          "),n("router-link",{attrs:{to:{name:"Upload"}}},[t._v("\n            Upload your timetable\n          ")])],1)],1)],1),t._l(t.modGroups,function(e,a){return n("v-flex",{key:a,attrs:{xs12:"",value:e.active}},[n("v-card",[n("v-card-title",{staticClass:"headline"},[t._v(t._s(e.title))]),n("v-list",t._l(e.modules,function(e){return n("v-list-group",{key:e.code},[n("v-list-tile",{attrs:{slot:"activator"},slot:"activator"},[n("v-list-tile-content",[n("v-list-tile-title",[t._v(t._s(e.title))]),n("v-list-tile-sub-title",[t._v(t._s(e.code))])],1)],1),t._l(e.sections,function(e){return n("v-list-tile",{key:e,on:{click:function(n){t.toggle(e)}}},[n("v-list-tile-content",[n("v-list-tile-title",[t._v(t._s(t.term[e].name))])],1),n("v-list-tile-action",[t.selected.indexOf(e)>-1?n("v-icon",[t._v("check_box")]):n("v-icon",[t._v("check_box_outline_blank")])],1)],1)})],2)}))],1)],1)})],2)],1)},Gt=[],Lt=[[/^01/,"General"],[/^02/,"HASS"],[/^(03|10)/,"Freshmore"],[/^20/,"ASD"],[/^30/,"EPD"],[/^40/,"ESD"],[/^50/,"ISTD"]],Rt={data:function(){return{}},computed:{selected:function(){return this.$root.selected},term:function(){if(!this.$root.timetable.term)return{};var t=this.$root.timetable.term.join("-");return this.$root.timetable.sections[t]},modGroups:function(){var t=this,e=function(t){return function(e){return t.test(e.code)}};return Lt.map(function(n){var a=n[1],o=Object.values(t.$root.timetable.modules).filter(e(n[0]));return{title:a,modules:o,active:!1}})}},methods:{toggle:function(t){var e=this.selected.indexOf(t);e>-1?this.selected.splice(e,1):this.selected.push(t)}}},Vt=Rt,Pt=Object(z["a"])(Vt,At,Gt,!1,null,null,null);Pt.options.__file="Modules.vue";var Bt=Pt.exports;a["default"].use(nt["a"]);var Ut=[{path:"/main",name:"Main",component:ut},{path:"/upload",name:"Upload",component:Dt},{path:"/mods",name:"Modules",component:Bt},{path:"*",redirect:"/main"}],It=new nt["a"]({routes:Ut,scrollBehavior:function(){return{x:0,y:0}}}),Ft=n("5f30"),Nt=n.n(Ft),Ht=n("59ca"),qt=n.n(Ht),Yt=(n("66ce"),qt.a.initializeApp({projectId:"sutd-timetable",messagingSenderId:"264299846651",storageBucket:"sutd-timetable.appspot.com",authDomain:"sutd-timetable.firebaseapp.com",apiKey:"AIzaSyBefOvL56JqZpZbA1jqojMlM0u5ais4CYo",databaseURL:"https://sutd-timetable.firebaseio.com"}));a["default"].use(Nt.a);var Wt={timetable:{asObject:!0,source:Yt.database().ref()}};a["default"].config.productionTip=!1;var Qt={selected:[]};new a["default"]({data:Qt,router:It,firebase:Wt,render:function(t){return t(et)}}).$mount("#app")},"9ba3":function(t,e,n){},b91f:function(t,e,n){"use strict";var a=n("9ba3"),o=n.n(a);o.a}});
//# sourceMappingURL=app.53242222.js.map